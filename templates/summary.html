<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Fitness Tailor</title>
        <link rel="stylesheet" href="/static/css/w3.css">
        <link rel="stylesheet" href="/static/css/main.css">
        <link rel="stylesheet" href="/static/css/tooltip.css">
        <link rel="stylesheet" href="/static/css/scrollbar.css">
    </head>

    <script>
        function openWorkout(workoutName) {
          var i;
          var x = document.getElementsByClassName("workout");
          for (i = 0; i < x.length; i++) {

            x[i].style.display = "none";
          }
          document.getElementById(workoutName).style.display = "block";
        }

        function checkCompleted() {
            var checkboxes = document.forms.check_complete.elements;

            var incomplete = []

            for (var i = 0; i < checkboxes.length; i++) {
                if (checkboxes[i].checked) {
                    continue;
                } else {
                    incomplete.push(checkboxes[i].getAttribute("name"))
                }
            }

            if (incomplete.length == 0) {
                document.getElementById("check_complete").submit();
            } else {

                document.getElementById("finish_workout").style.display = "block";

                document.getElementById("finish_workout").innerHTML = "FOLLOWING EXERCISES NOT COMPLETED:<br>";

                for (i = 0; i < incomplete.length; i++) {
                    document.getElementById("finish_workout").innerHTML = document.getElementById("finish_workout").innerHTML + "- " + incomplete[i] + "<br>";
                }

            }

        }

    </script>

    <body style="background-color:#ff9e0f">
        {% include 'snips/header.html' %}

        <div style="display:table;width:100%">
            <div class="w3-container w3-theme" style="width:24%;height:50px;display:table-cell"> </div>
            <div class="w3-container" style="display:table-cell">
                    <h2 class="w3-staatliches w3-right" style="font-size:24px">WORKOUTS CURATED JUST FOR YOU</h2>
            </div>
        </div>

        <div class="w3-sidebar w3-theme w3-bar-block w3-staatliches" style="font-size:30px;width:24%;margin-bottom:100px;height:80%">

            <div class="w3-container w3-center" style="border-bottom:3px solid black;">
                <p class="w3-text-theme">Workout Summary</p>
                <p>Energy Level: {{ energy }}</p>
            </div>

            <p class="w3-text-theme w3-center">Exercises</p>

            {% for exercise in exercise_list %}
                <button class="w3-bar-item w3-button w3-center w3-animate-opacity" onclick="openWorkout({{ exercise['id'] }})">
                    {{ exercise['exercise'] }}
                </button>
            {% endfor %}

            <button class="w3-bar-item w3-button w3-center w3-animate-opacity w3-yellow" onclick="checkCompleted()">
                FINISH WORKOUT
            </button>

            <span class="w3-bar-item w3-center w3-animate-opacity w3-red" id="finish_workout" style="display:none;font-size:16px"></span>

            <br>

        </div>

        <div class="w3-container w3-animate-opacity" style="margin-left:25%;font-family:Trebuchet MS, Helvetica, sans-serif;">

            <form id="check_complete" action="{{ url_for('complete') }}" method="POST">

            {% set ns = namespace(ex=0) %}
            {% for exercise in exercise_list %}
                {% if ns.ex == 0 %}
                    <div class="workout" id="{{ exercise['id'] }}" style="display:block">
                    {% set ns.ex = ns.ex + 1 %}
                {% else %}
                    <div class="workout" id="{{ exercise['id'] }}" style="display:none">
                {% endif %}

                        <h3 class="w3-staatliches" style="font-size: 40px">
                            {{ exercise['exercise'] }}
                        </h3>
                        <div class="w3-staatliches" style="font-size: 20px">
                            Difficulty: {{ exercise['level'] }}
                        </div>
                        <p class="w3-container">
                            {% if 'youtube' in exercise['video'] %}
                                <iframe width="420" height="315" src="{{ exercise['video'] }}" frameBorder="0">
                                </iframe>
                            {% else %}
                                <video src="http://{{ exercise['video'] }}" width="420" height="315" controls style="outline:0">
                                </video>
                            {% endif %}
                        </p>
                        <span class="w3-staatliches" style="font-size: 20px">
                            Equipment required
                        </span>
                        <br>
                        <br>
                        <span class="tooltip" style="margin-right:20px;">
                            <img src="/static/images/icons/equipment/{{ exercise['equipment'] }}.jpg" alt="{{ exercise['equipment'] }}" width="auto" height="200px" style="float:left;height:70px; width:70px; vertical-align:middle;border-radius: 80%;border:1px solid black;">
                            <span class="tooltiptext w3-animate-opacity w3-theme" style="font-size:10px;">
                                    {{ exercise['equipment'] }}
                            </span>
                        </span>
                        <span class="w3-container" >
                            <span class="w3-staatliches" style="font-size: 20px">
                                Muscle groups affected
                            </span>
                            <br>
                            <br>
                            {% set primary = namespace(ex=0) %}
                            {% for muscle in exercise['muscle'] %}
                                {% if primary.ex == 0 %}
                                    <span class="tooltip" style="margin-right:20px;">
                                        <img src="/static/images/icons/muscles/{{ muscle }}.jpg" width="auto" height="200px" style="float:left;height:70px; width:70px; vertical-align:middle;border-radius: 80%;border:1px solid black;box-shadow: 0 0 10pt 3pt rgba(0,255,0,1);">
                                        <span class="tooltiptext w3-theme w3-animate-opacity" style="font-size:10px;">
                                            {{ muscle }}
                                            <br>
                                            (Primary)
                                        </span>
                                    </span>
                                    {% set primary.ex = primary.ex + 1 %}
                                {% else %}
                                    <span class="tooltip" style="margin-right:20px;">
                                        <img src="/static/images/icons/muscles/{{ muscle }}.jpg" width="auto" height="200px" style="float:left;height:70px; width:70px; vertical-align:middle;border-radius: 80%;border:1px solid black;box-shadow: 0 0 10pt 3pt rgba(255,255,0,1);">
                                        <span class="tooltiptext w3-theme w3-animate-opacity" style="background-color:transparent;font-size:10px;">
                                            {{ muscle }}
                                            <br>
                                            (Secondary)
                                        </span>
                                    </span>
                                {% endif %}
                            {% endfor %}
                        </span>
                        <br>
                        <label>
                            <input type="checkbox" name="{{ exercise['exercise'] }}" value="uncomplete" style="transform:scale(3);margin:10px">
                            <span style="font-size:24px">Exercise Completed</span>
                        </label>
                        {% set rpe = energy_value | int %}
                        {% set rpe = 5 + rpe/3 %}
                        <b style="font-size:20px">
                                <p>
                                    Reps: 3 sets of 10
                                    <span class="w3-tooltip">(RPE {{ rpe | int }})
                                        <span class="w3-text w3-theme w3-tag w3-animate-opacity">
                                            {% set reps = 10-rpe %}
                                            Add enough weight such that you can finish your sets while still being able to do {{ reps | int }} more reps.
                                        </span>
                                    </span>
                                </p>
                                <p>
                                    Time between sets: 1-3 min
                                </p>

                                Instructions:
                                <br>
                        </b>
                            {% set i = namespace(ex=1) %}
                            {% for line in exercise['description'] %}
                                {{ i.ex }}. {{ line }}
                                <br>
                                <br>
                                {% set i.ex = i.ex + 1 %}

                            {% endfor %}

                    </div>

            {% endfor %}

            </form>

        </div>

    </body>
</html>