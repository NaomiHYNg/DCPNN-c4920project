<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Fitness Tailor</title>
        <link rel="stylesheet" href="/static/css/w3.css">
        <link rel="stylesheet" href="/static/css/main.css">
    </head>

    <script>
        function openWorkout(workoutName) {
          var i;
          var x = document.getElementsByClassName("workout");
          for (i = 0; i < x.length; i++) {

            x[i].style.display = "none";
          }
          document.getElementById(workoutName).style.display = "block";
        }

        function checkCompleted() {
            var checkboxes = document.forms.check_complete.elements;

            var incomplete = []

            for (var i = 0; i < checkboxes.length; i++) {
                if (checkboxes[i].checked) {
                    continue;
                } else {
                    incomplete.push(checkboxes[i].getAttribute("name"))
                }
            }

            if (incomplete.length == 0) {
                document.getElementById("check_complete").submit();
            } else {

                document.getElementById("finish_workout").style.display = "block";

                document.getElementById("finish_workout").innerHTML = "FOLLOWING EXERCISES NOT COMPLETED:<br>";

                for (i = 0; i < incomplete.length; i++) {
                    document.getElementById("finish_workout").innerHTML = document.getElementById("finish_workout").innerHTML + "- " + incomplete[i] + "<br>";
                }

            }

        }

    </script>

    <body style="background-color:#ff9e0f">
        {% include 'snips/header.html' %}

        <div class="w3-sidebar w3-theme w3-bar-block w3-staatliches" style="font-size:30px;width:25%;margin-bottom:100px;height:90%">

            <div class="w3-container w3-center" style="border-bottom:3px solid black;">
                <p class="w3-text-theme">Workout Summary</p>
                <p>Energy Level: {{ energy }}</p>
            </div>

            <p class="w3-text-theme w3-center">Exercises</p>

            {% for exercise in exercise_list %}
                <button class="w3-bar-item w3-button w3-center w3-animate-opacity" onclick="openWorkout({{ exercise['id'] }})">
                    {{ exercise['exercise'] }}
                </button>
            {% endfor %}

            <button class="w3-bar-item w3-button w3-center w3-animate-opacity w3-yellow" onclick="checkCompleted()">
                FINISH WORKOUT
            </button>

            <span class="w3-bar-item w3-center w3-animate-opacity w3-red" id="finish_workout" style="display:none;font-size:16px"></span>

            <br>

        </div>

        {% include 'snips/header2.html' %}

        <div class="w3-container w3-animate-opacity" style="margin-left:25%; font-family:Trebuchet MS, Helvetica, sans-serif">

            <form id="check_complete" action="{{ url_for('complete') }}" method="POST">

            {% set ns = namespace(ex=0) %}
            {% for exercise in exercise_list %}
                {% if ns.ex == 0 %}
                    <div class="workout" id="{{ exercise['id'] }}" style="display:block">
                    {% set ns.ex = ns.ex + 1 %}
                {% else %}
                    <div class="workout" id="{{ exercise['id'] }}" style="display:none">
                {% endif %}

                        <h3 class="w3-staatliches" style="font-size: 40px">
                            {{ exercise['exercise'] }}
                        </h3>
                        <p>
                            <b>Muscle trained: {{ exercise['muscle'] }}</b>
                        </p>
                        <p>
                            {% for image in exercise['photo'] %}
                                <img src="{{ image }}" alt="exercise_photo" width="auto" height="200px" style="float:left">
                            {% endfor %}
                        </p>

                        <p style="clear:left">
                        <input type="checkbox" name="{{ exercise['exercise'] }}" value="uncomplete" style="transform:scale(3);margin:10px">
                            <span style="font-size:24px">Exercise Completed</span>
                        {% set rpe = energy_value | int %}
                        {% set rpe = 5 + rpe/3 %}
                        <b style="font-size:20px">
                                <p>
                                    Reps: 3 sets of 10
                                    <span class="w3-tooltip">(RPE {{ rpe | int }})
                                        <span class="w3-text w3-theme w3-tag w3-animate-opacity">
                                            {% set reps = 10-rpe %}
                                            Finish your sets with {{ reps | int }} reps in the tank
                                        </span>
                                    </span>
                                </p>
                                <p>
                                    Time between sets: 1-3 min
                                </p>
                        </b>
                            {{ exercise['description'] }}
                        </p>

                    </div>

            {% endfor %}

            </form>

        </div>

    </body>
</html>